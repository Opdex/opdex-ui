<div class="review-tx-quote" *ngIf="quoteRequest && quoteReceipt">
  <ng-container *ngIf="!txHash; else success">
    <h4 class="{{quoteReceipt.success ? 'mb-1' : 'mb-3'}}">Transaction Quote</h4>

    <ng-container *ngIf="quoteReceipt.success">
      <opdex-tx-receipt [tx]="quoteReceipt" [showBottomDivider]="false" [showTimeAgo]="false" [collapsed]="false"></opdex-tx-receipt>

      <mat-divider></mat-divider>
    </ng-container>

    <div class="mt-2" *ngIf="quote?.error">
      <div class="d-flex d-row align-items-center mb-2">
        <opdex-help-button class="mr-2" [info]="errorHelp" [icon]="icons.error" iconColor="red"></opdex-help-button>
        <h6 class="mb-0 d-inline">Errors</h6>
      </div>

      <p>{{quote.error}}</p>
      <mat-divider></mat-divider>
    </div>

    <div *ngIf="quoteRequest" class="mt-2">
      <div class="d-flex d-row justify-content-between align-items-center mb-2">
        <div class="d-flex d-row align-items-center">
          <opdex-help-button class="mr-2" [info]="methodDetailsHelp"></opdex-help-button>
          <h6 class="mb-0 d-inline">Method Details</h6>
        </div>

        <div class="d-flex justify-content-center">
          <button mat-icon-button color="primary" class="small" (click)="toggleMethodDetails()">
            <mat-icon>{{showMethodDetails ? 'remove' : 'add'}}</mat-icon>
          </button>
        </div>
      </div>

      <ng-container *ngIf="showMethodDetails">
        <div class="mb-2">
          <small class="light d-block">Contract Method</small>
          <small class="d-block overflow-ellipsis">{{quoteRequest?.method}}</small>
        </div>

        <div class="mb-2">
          <small class="light d-block">Contract Address</small>
          <small class="d-block overflow-ellipsis">{{quoteReceipt?.to}}</small>
        </div>
      </ng-container>

      <ng-container *ngIf="quoteRequest.parameters?.length">
        <mat-divider></mat-divider>

        <div class="d-flex d-row justify-content-between align-items-center mt-2 mb-2">
          <div class="d-flex d-row align-items-center">
            <opdex-help-button class="mr-2" [info]="methodParametersHelp"></opdex-help-button>
            <h6 class="mb-0 d-inline">Method Parameters</h6>
          </div>

          <div class="d-flex justify-content-center">
            <button mat-icon-button color="primary" class="small" (click)="toggleParameterDetails()">
              <mat-icon>{{showParameterDetails ? 'remove' : 'add'}}</mat-icon>
            </button>
          </div>
        </div>

        <ng-container *ngIf="showParameterDetails">
          <div class="mb-2" *ngFor="let param of quoteRequest.parameters">
            <small class="light d-block">{{param.label}}</small>
            <small class="d-block overflow-ellipsis">{{param.value | contractParameter}}</small>
          </div>
        </ng-container>
      </ng-container>
    </div>

    <mat-divider></mat-divider>

    <opdex-qr-code [data]="quote?.request"></opdex-qr-code>

    <button mat-stroked-button class="w-100 mt-2" (click)="close()">Close</button>

    <ng-container *ngIf="isDevnet">
      <button mat-flat-button color="primary" class="w-100 mt-3 ml-0" (click)="submit()" [disabled]="submitting" cdkFocusInitial>{{!submitting ? 'Local Submit' : 'Submitting'}}</button>
      <mat-progress-bar mode="indeterminate" *ngIf="submitting" class="mt-3"></mat-progress-bar>
    </ng-container>
  </ng-container>

  <ng-template #success>
    <div class="d-flex flex-column justify-content-center align-items-center" style="min-height: 400px;">
      <span class="check-animation active">
        <span class="check-container">
          <mat-icon>check</mat-icon>
        </span>
      </span>

      <small class="text-center light mt-5 w-100" style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
        {{txHash}}
      </small>
    </div>
  </ng-template>
</div>

