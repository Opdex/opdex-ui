<opdex-card [hasToolbar]="true" style="position: relative;" [noPadding]="true">
  <ng-container toolbar>
    <div class="details">
      <h4 class="title d-inline">Recent Transactions</h4>
    </div>
  </ng-container>

  <div #feedContainer class="feed-container" [ngClass]="{'large': size === 'l', 'medium': size === 'm', 'small': size === 's'}" style="position: relative;">
    <ng-container *ngIf="!loading; else loader">
      <ng-container *ngIf="transactions?.length > 0; else noTransactions">
        <div class="transaction" *ngFor="let tx of transactions; trackBy: transactionsTrackBy; let i = index">
          <div class="tx-container" [ngClass]="{'pb-0': i >= transactions.length - 1}">
            <div class="d-flex flex-row align-items-center w-100 mb-1">
              <div class="icon-container">
                <opdex-copy-button
                  [tooltip]="tx.hash"
                  [value]="tx.hash"
                  [icon]="tx.transactionType?.icon || icons.error"
                  [size]="iconSizes.small"
                  [color]="tx.transactionType?.iconColor || 'error'"></opdex-copy-button>
              </div>

              <div class="w-100 d-flex light justify-content-between">
                <small>{{tx?.transactionSummary}}</small>
                <small>{{tx?.block?.medianTime | timeago}}</small>
              </div>
            </div>

            <div class="w-100 icon-container-offset" *ngIf="tx.transactionType; else invalid">
              <ng-container [ngSwitch]="tx.transactionType.title">
                <opdex-swap-transaction-summary [transaction]="tx" *ngSwitchCase="'Swap'"></opdex-swap-transaction-summary>
                <opdex-provide-transaction-summary [transaction]="tx" *ngSwitchCase="'Provide'"></opdex-provide-transaction-summary>
                <opdex-mine-transaction-summary [transaction]="tx" *ngSwitchCase="'Mine'"></opdex-mine-transaction-summary>
                <opdex-stake-transaction-summary [transaction]="tx" *ngSwitchCase="'Stake'"></opdex-stake-transaction-summary>
                <opdex-enable-mining-transaction-summary [transaction]="tx" *ngSwitchCase="'Enable Mining'"></opdex-enable-mining-transaction-summary>
                <opdex-create-pool-transaction-summary [transaction]="tx" *ngSwitchCase="'Create Pool'"></opdex-create-pool-transaction-summary>
                <opdex-distribute-transaction-summary [transaction]="tx" *ngSwitchCase="'Distribute'"></opdex-distribute-transaction-summary>
                <opdex-allowance-transaction-summary [transaction]="tx" *ngSwitchCase="'Allowance'"></opdex-allowance-transaction-summary>
              </ng-container>
            </div>

            <ng-template #invalid>
              <div class="icon-container-offset d-flex flex-row align-items-center">
                Unable to read transaction summary.
              </div>
            </ng-template>
          </div>

          <mat-divider *ngIf="i < transactions.length - 1" style="position: relative;"></mat-divider>
        </div>

        <div class="paginator d-flex justify-content-center mt-2 mb-2">
          <button mat-button color="primary" [disabled]="!nextPage" (click)="more()">More <mat-icon>{{icons.arrowDown}}</mat-icon></button>
        </div>
      </ng-container>
      <ng-template #noTransactions>
        <div class="mt-2 mb-2">
          No transactions found.
        </div>
      </ng-template>
    </ng-container>

    <ng-template #loader>
      <div class="transaction" *ngFor="let tx of placeholders; let i = index">
        <div class="tx-container" [ngClass]="{'pb-0': i >= placeholders.length - 1}">
          <div class="d-flex flex-row align-items-center w-100 mb-1">
            <div class="icon-container">
              <opdex-copy-button
                [tooltip]="'Loading hash'"
                [value]="'Loading hash'"
                [icon]="icons.swap"
                [size]="iconSizes.small"
                [color]="'primary'"></opdex-copy-button>
            </div>

            <div class="w-100 d-flex light justify-content-between">
              <small>type</small>
              <small>time ago</small>
            </div>
          </div>

          <div class="w-100 icon-container-offset">
            Loading transaction summary
          </div>
        </div>

        <mat-divider *ngIf="i < placeholders.length - 1" style="position: relative;"></mat-divider>
      </div>
    </ng-template>
  </div>

  <div class="d-flex justify-content-center" style="position: absolute; top: 45px; left: 0; right: 0; margin: 0 auto;"  *ngIf="refreshAvailable" >
    <button mat-flat-button color="primary" (click)="refresh()" style="border-radius: 20px;">Refresh</button>
  </div>
</opdex-card>
